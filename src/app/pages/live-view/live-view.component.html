<!-- LiveView Component Template -->
<div class="live-view-page">
  <div class="container-fluid">
    <!-- Live View Control Panel -->
    <div class="row mb-3">
      <div class="col-12">
        <div class="live-view-control-panel">
          <div class="control-item">
            <label class="control-label">Canlı İzle:</label>
            <label class="switch">
              <input 
                type="checkbox" 
                [(ngModel)]="isLiveViewEnabled"
                (change)="toggleLiveView(isLiveViewEnabled)">
              <span class="slider"></span>
            </label>
          </div>
          <div class="control-item">
            <span class="control-info">Kayıt Sayısı: {{ liveViewRecords.length }}</span>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Data Table Section -->
    <div class="row">
      <div class="col-12">
        <ui-data-table
          [id]="'live-view-grid'"
          [showFooter]="true"
          [page]="1"
          [columns]="tableColumns"
          [dataSource]="tableDataSource"
          [canViewDeleted]="false"
          [selectable]="true"
          [pagination]="false"
          [height]="'calc(100vh - 200px)'"
          [recordHeight]="recordHeight"
          [showEmptyRows]="false"
          [fixedBody]="true"
          [advancedFilter]="false"
          [showRefresh]="true"
          [searchPlaceholder]="'Ara...'"
          [recid]="'Id'"
          [selectType]="'row'"
          [multiSelect]="false"
          [multiSort]="false"
          [keyboard]="true"
          [liveSearch]="true"
          [reorderColumns]="false"
          [reorderRows]="false"
          [lineNumbers]="false"
          [expandColumn]="false"
          [nestedFields]="true"
          [columnTooltip]="'top'"
          [toolbar]="tableToolbarConfig"
          (rowClick)="onTableRowClick($event)"
          (rowDblClick)="onTableRowDblClick($event)"
          (rowSelect)="onTableRowSelect($event)"
          (advancedFilterChange)="onAdvancedFilterChange($event)"
          (refresh)="onTableRefresh()"
          (delete)="onTableDelete($event)"
          (add)="onTableAdd()"
          (edit)="onTableEdit($event)">
        </ui-data-table>
      </div>
    </div>
  </div>
</div>

<!-- Filter Modal -->
<ui-modal
  [show]="showFilterModal"
  [title]="'Terminal Gruplarını Seç'"
  [size]="'lg'"
  [closable]="true"
  [showFooter]="true"
  (showChange)="onCloseFilterModal()">
  <div class="filter-modal-content">
    <div class="form-group">
      <label>Grup:</label>
      <ui-select
        [(ngModel)]="selectedLiveViewSettingId"
        [options]="liveViewSettings"
        [placeholder]="'Grup seçiniz...'"
        (ngModelChange)="onLiveViewSettingChange()">
      </ui-select>
    </div>
    
    <!-- Terminals List -->
    <div class="form-group" *ngIf="selectedTerminals.length > 0">
      <label>Seçili Terminaller ({{ selectedTerminals.length }}):</label>
      <div class="terminals-list-container">
        <ui-data-table
          [id]="'filter-terminals-grid'"
          [columns]="terminalsTableColumns"
          [dataSource]="terminalsDataSource"
          [selectable]="false"
          [pagination]="true"
          [pageSize]="10"
          [height]="'300px'"
          [recid]="'ReaderID'"
          [showRefresh]="false"
          [searchable]="false"
          [showFooter]="true"
          [toolbar]="terminalsTableToolbarConfig">
        </ui-data-table>
      </div>
    </div>
    
    <div class="form-group" *ngIf="selectedLiveViewSettingId && selectedTerminals.length === 0">
      <div class="alert alert-info">
        <i class="ti ti-info-circle me-2"></i>
        Bu grup için terminal bulunamadı.
      </div>
    </div>
  </div>
  
  <div slot="footer" class="modal-footer">
    <button 
      type="button" 
      class="btn btn-secondary" 
      (click)="onCloseFilterModal()">
      İptal
    </button>
    <button 
      type="button" 
      class="btn btn-primary" 
      (click)="onApplyFilter()"
      [disabled]="selectedTerminals.length === 0">
      Tamam
    </button>
  </div>
</ui-modal>

<!-- Row Size Modal -->
<ui-modal
  [show]="showRowSizeModal"
  [title]="'Satır Yüksekliğini Düzenle'"
  [size]="'sm'"
  [closable]="true"
  [showFooter]="true"
  (showChange)="onCloseRowSizeModal()">
  <div class="row-size-modal-content">
    <div class="form-group">
      <label>Satır Yüksekliği:</label>
      <input 
        type="number" 
        class="form-control"
        [(ngModel)]="newRowSize"
        min="40"
        max="200">
    </div>
  </div>
  
  <div slot="footer" class="modal-footer">
    <button 
      type="button" 
      class="btn btn-secondary" 
      (click)="onCloseRowSizeModal()">
      İptal
    </button>
    <button 
      type="button" 
      class="btn btn-primary" 
      (click)="onApplyRowSize()">
      Ayarla
    </button>
  </div>
</ui-modal>
