<!-- Employee Component Template - Adapted from old app.component.html -->
<!-- NOTE: This template requires DataTableComponent (ui-data-table) to be created -->
<!-- The structure is ready but DataTableComponent needs to be implemented -->

<div class="employee-page">
  <div class="container-fluid">
    <!-- Data Table Section -->
    <div class="row">
      <div class="col-12">
        <ui-data-table
          [id]="'employees-grid'"
          [showFooter]="true"
          [page]="1"
          [columns]="tableColumns"
          [dataSource]="tableDataSource"
          [joinOptions]="joinOptions"
          [canViewDeleted]="true"
          [formFields]="formFields"
          [formTabs]="formTabs"
          [formLoadUrl]="formLoadUrl"
          [formFullscreen]="true"
          [formLoadRequest]="formLoadRequest"
          [formDataMapper]="formDataMapper"
          [imageUploadUrl]="imageUploadUrl"
          [imageField]="imageField"
          [imagePreviewUrl]="imagePreviewUrl"
          [onSave]="onSave"
          [onFormChange]="onFormChange"
          [getGridColumns]="getGridColumns"
          [getGridDataSource]="getGridDataSource"
          [selectable]="true"
          [pagination]="true"
          [pageSize]="10"
          [height]="'800px'"
          [recordHeight]="40"
          [showEmptyRows]="true"
          [fixedBody]="true"
          [advancedFilter]="true"
          [showRefresh]="true"
          [searchPlaceholder]="translate.instant('table.searchPlaceholder')"
          [recid]="'EmployeeID'"
          [selectType]="'row'"
          [multiSelect]="true"
          [multiSort]="true"
          [keyboard]="true"
          [liveSearch]="true"
          [reorderColumns]="false"
          [reorderRows]="false"
          [lineNumbers]="false"
          [expandColumn]="false"
          [nestedFields]="true"
          [columnTooltip]="'top'"
          [toolbar]="tableToolbarConfig"
          (rowClick)="onTableRowClick($event)"
          (rowDblClick)="onTableRowDblClick($event)"
          (rowSelect)="onTableRowSelect($event)"
          (contextMenu)="onTableContextMenu($event)"
          (columnClick)="onTableColumnClick($event)"
          (pictureClick)="onPictureClick($event)"
          (columnDblClick)="onTableColumnDblClick($event)"
          (columnContextMenu)="onTableColumnContextMenu($event)"
          (columnResize)="onTableColumnResize($event)"
          (mouseEnter)="onTableMouseEnter($event)"
          (mouseLeave)="onTableMouseLeave($event)"
          (focus)="onTableFocus()"
          (blur)="onTableBlur()"
          (copy)="onTableCopy($event)"
          (paste)="onTablePaste($event)"
          (advancedFilterChange)="onAdvancedFilterChange($event)"
          (refresh)="onTableRefresh()"
          (delete)="onTableDelete($event)"
          (add)="onTableAdd()"
          (edit)="onTableEdit($event)">
        </ui-data-table>
      </div>
    </div>
  </div>
</div>

<!-- Format Modal -->
<ui-modal
  [title]="translate.instant('card.format')"
  [show]="showFormatModal"
  [size]="'md'"
  [closable]="true"
  [showFooter]="true"
  (showChange)="showFormatModal = $event"
  (closed)="closeFormatModal()">
  
  <!-- Modal Body: Reader List -->
  <div class="reader-list-container">
    <div *ngIf="isLoadingReaders" class="loading-container">
      <div class="spinner"></div>
      <p>{{ translate.instant('common.loading') }}</p>
    </div>
    
    <div *ngIf="!isLoadingReaders && readers.length === 0" class="empty-container">
      <p>{{ translate.instant('common.noData') }}</p>
    </div>
    
    <ul *ngIf="!isLoadingReaders && readers.length > 0" class="reader-list">
      <li 
        *ngFor="let reader of readers" 
        class="reader-item"
        [class.reader-connected]="getReaderStatus(reader) === 'connected'"
        [class.reader-disconnected]="getReaderStatus(reader) === 'disconnected'"
        [class.reader-checking]="getReaderStatus(reader) === 'checking'"
        [class.reader-selectable]="isReaderSelectable(reader)"
        (click)="onReaderItemClick(reader, $event)">
        <div class="reader-status-indicator">
          <span 
            class="status-dot"
            [class.status-connected]="getReaderStatus(reader) === 'connected'"
            [class.status-disconnected]="getReaderStatus(reader) === 'disconnected'"
            [class.status-checking]="getReaderStatus(reader) === 'checking'">
          </span>
        </div>
        <div class="reader-info">
          <span class="reader-name">{{ reader.ReaderName || reader.name || reader.Name || 'Reader ' + (reader.ReaderID || reader.id) }}</span>
          <div class="reader-details">
            <span *ngIf="reader.SerialNumber" class="reader-detail-item">
              <strong>Seri No:</strong> {{ reader.SerialNumber }}
            </span>
            <span *ngIf="reader.IpAddress" class="reader-detail-item">
              <strong>IP:</strong> {{ reader.IpAddress }}
            </span>
            <span *ngIf="reader.ReaderType" class="reader-detail-item">
              <strong>Tip:</strong> {{ reader.ReaderType }}
            </span>
            <span *ngIf="reader.ReaderPort" class="reader-detail-item">
              <strong>Port:</strong> {{ reader.ReaderPort }}
            </span>
            <span *ngIf="getReaderMessage(reader)" class="reader-detail-item reader-message">
              <strong>Durum:</strong> {{ getReaderMessage(reader) }}
            </span>
          </div>
        </div>
        <span class="reader-id">ID: {{ reader.ReaderID || reader.id }}</span>
      </li>
    </ul>
  </div>
  
  <!-- Modal Footer -->
  <div slot="footer" class="modal-footer-actions">
    <button 
      type="button" 
      class="btn btn-secondary"
      (click)="closeFormatModal()">
      {{ translate.instant('common.cancel') }}
    </button>
  </div>
</ui-modal>
