<div class="manual-door-trigger-page">
  <div class="container-fluid">
    <div class="row">
      <div class="col-12">
        <div class="door-trigger-container" [style.height]="gridHeight">
          <!-- Left Panel: Tab panel (Kapılar, Inputlar, Outputlar) -->
          <div class="door-trigger-panel">
            <div class="door-trigger-panel-body door-trigger-tabs-wrapper">
              <ui-tabs
                [(activeTab)]="activeTab"
                variant="default"
                (activeTabChange)="activeTab = $event">
                <ui-tab-item label="Kapılar">
                  <div class="door-trigger-tab-content">
                    <ui-data-table
                      #doorsGrid
                      [id]="'doors-grid'"
                      [columns]="doorsTableColumns"
                      [dataSource]="doorsDataSource"
                      [selectable]="true"
                      [pagination]="true"
                      [pageSize]="100"
                      [limit]="-1"
                      [height]="tabGridHeight"
                      [recid]="'SerialNumber'"
                      [selectType]="'row'"
                      [multiSelect]="true"
                      [showRefresh]="true"
                      [searchable]="true"
                      [advancedFilter]="true"
                      [showFooter]="true"
                      [toolbar]="doorsTableToolbarConfig"
                      [searchPlaceholder]="'Ara Tüm Alanlar'"
                      [getRowClass]="getDoorRowClass"
                      (rowSelect)="onDoorSelect($event)">
                    </ui-data-table>
                  </div>
                </ui-tab-item>
                <ui-tab-item label="Inputlar">
                  <div class="door-trigger-tab-content">
                    <ui-data-table
                      #inputsGrid
                      [id]="'inputs-grid'"
                      [columns]="inputsTableColumns"
                      [dataSource]="inputsDataSource"
                      [selectable]="true"
                      [selectType]="'row'"
                      [multiSelect]="true"
                      [pagination]="true"
                      [pageSize]="100"
                      [limit]="-1"
                      [height]="tabGridHeight"
                      [recid]="'SerialNumber'"
                      [showRefresh]="true"
                      [searchable]="true"
                      [advancedFilter]="true"
                      [showFooter]="true"
                      [toolbar]="inputsOutputsToolbarConfig"
                      [searchPlaceholder]="'Ara Tüm Alanlar'">
                    </ui-data-table>
                  </div>
                </ui-tab-item>
                <ui-tab-item label="Outputlar">
                  <div class="door-trigger-tab-content">
                    <ui-data-table
                      #outputsGrid
                      [id]="'outputs-grid'"
                      [columns]="outputsTableColumns"
                      [dataSource]="outputsDataSource"
                      [selectable]="true"
                      [selectType]="'row'"
                      [multiSelect]="true"
                      [pagination]="true"
                      [pageSize]="100"
                      [limit]="-1"
                      [height]="tabGridHeight"
                      [recid]="'SerialNumber'"
                      [showRefresh]="true"
                      [searchable]="true"
                      [advancedFilter]="true"
                      [showFooter]="true"
                      [toolbar]="inputsOutputsToolbarConfig"
                      [searchPlaceholder]="'Ara Tüm Alanlar'">
                    </ui-data-table>
                  </div>
                </ui-tab-item>
              </ui-tabs>
            </div>
          </div>

          <!-- Right Panel: Form (Input sekmesinde pasif) -->
          <div class="door-trigger-panel" [class.panel-disabled]="isOperationsPanelDisabled">
            <div class="door-trigger-panel-header">
              <h4 class="door-trigger-panel-title">İşlem Ayarları</h4>
            </div>
            <div class="door-trigger-panel-body">
              <ui-form 
                [title]="''"
                layout="vertical"
                [showJsonOutput]="false">
                
                <div class="form-content">
                  <!-- Process Type Field -->
                  <ui-form-field 
                    label="İşlem Tipi"
                    [required]="true">
                    <ui-select
                      [(ngModel)]="formData.processType"
                      [options]="processTypeOptions"
                      [placeholder]="'İşlem tipi seçiniz...'"
                      [disabled]="isOperationsPanelDisabled"
                      (ngModelChange)="onProcessTypeChange($event)">
                    </ui-select>
                  </ui-form-field>

                  <!-- Process Duration (Minutes) Field -->
                  <ui-form-field 
                    label="İşlem Süresi (dk)"
                    [required]="formData.processType === '**'">
                    <ui-input
                      type="number"
                      [(ngModel)]="formData.processTickM"
                      [placeholder]="'Dakika'"
                      [disabled]="isOperationsPanelDisabled || formData.processType !== '**'"
                      [min]="0">
                    </ui-input>
                  </ui-form-field>

                  <!-- Process Duration (Seconds) Field -->
                  <ui-form-field 
                    label="İşlem Süresi (sn)"
                    [required]="formData.processType === '**'">
                    <ui-input
                      type="number"
                      [(ngModel)]="formData.processTick"
                      [placeholder]="'Saniye'"
                      [disabled]="isOperationsPanelDisabled || formData.processType !== '**'"
                      [min]="0">
                    </ui-input>
                  </ui-form-field>

                  <!-- Info Message -->
                  <div class="form-info">
                    <div class="alert alert-info">
                      <i class="ti ti-info-circle me-2"></i>
                      <div>
                        <strong>İşlem Tipleri:</strong>
                        <ul>
                          <li><strong>Sınırsız:</strong> Kapı süresiz olarak açık kalır</li>
                          <li><strong>Kapat:</strong> Kapı kapatılır</li>
                          <li><strong>Süreli:</strong> Belirtilen süre kadar açık kalır</li>
                        </ul>
                      </div>
                    </div>
                  </div>

                  <!-- Selected Doors Count -->
                  <div class="selected-info" *ngIf="selectedDoors.length > 0">
                    <div class="alert alert-success">
                      <i class="ti ti-check me-2"></i>
                      <strong>{{ selectedDoors.length }}</strong> kapı seçildi
                    </div>
                  </div>

                  <!-- Action Buttons -->
                  <div class="form-actions">
                    <ui-button 
                      variant="secondary" 
                      size="md"
                      [disabled]="isOperationsPanelDisabled"
                      (clicked)="resetForm()">
                      <i class="ti ti-refresh me-2"></i>
                      Sıfırla
                    </ui-button>
                    
                    <ui-button 
                      variant="primary" 
                      size="md"
                      (clicked)="onSave()"
                      [disabled]="isOperationsPanelDisabled || selectedDoors.length === 0">
                      <i class="ti ti-check me-2"></i>
                      Kaydet
                    </ui-button>
                  </div>
                </div>
              </ui-form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
